<% include ../partials/header %>

	<section id="showBanner" data-type="background" data-speed="5" style="background-image: url(<%= campground.image %>) 50% 0 repeat fixed">
		<div id="bannerContent" class="container clearfix">
			<!-- <div class="thumbnail"> -->
				<div id="bannerImage" class="jumbotron" style="background-image: url(<%= campground.image %>)">
					<h4 class="pull-right">$<%= campground.cost %> /night</h4>
					<h1><%= campground.name %></h1>
					<h4><em>Submitted by; </em><a href="/users/<%= campground.author.id %>"><%= campground.author.username %></a></h4><span class="date pull-right"><%= moment(campground.created).fromNow() %></span>
					<% if(currentUser && campground.author.id.equals(currentUser._id) || currentUser && currentUser.isAdmin){ %>
						<a class="btn btn-warning" href="/campgrounds/<%= campground._id%>/edit">Edit</a>
						<form class="delete-form" action="/campgrounds/<%= campground._id %>?_method=DELETE" method="POST">
							<button class="btn btn-danger">Delete</button>
						</form>
					<% } %>
				</div>
				<!-- <img src="<%= campground.image %>"> -->
			<!-- </div> -->
		</div>
	</section>

	<div class="container">
		<div class="caption">
			<p>
				<%- campground.description %>
			</p>
		</div>
		<div class="row">
			<div class="col-md-4">
				<!-- <div class="list-group">
					<li class="list-group-item active">Info 1</li>
					<li class="list-group-item">Info 2</li>
					<li class="list-group-item">Info 3</li>
				</div> -->
				<div id="map"></div>
			</div>
			<div class="col-md-8">
				<% include ../partials/errors %>
				<div class="well">
					<div class="text-right">
						<p><a class="btn btn-success" href="/campgrounds/<%= campground._id %>/comments/new">Add a new comment.</a></p>
					</div>
					<hr>
					<% campground.comments.forEach(function(comment) { %>
						<div class="row">
							<div class="col-md-12">
								<strong><%= comment.author.username %></strong>
								<span class="date pull-right"><%= moment(comment.created).fromNow() %></span>
								<p>
									<%= comment.text %>
								</p>
								<% if(currentUser && comment.author.id.equals(currentUser._id) || currentUser && currentUser.isAdmin){ %>
									<a class="btn btn-xs btn-warning" href="/campgrounds/<%= campground._id %>/comments/<%= comment._id %>/edit">Edit</a>
									<form class="delete-form" action="/campgrounds/<%= campground._id %>/comments/<%= comment._id %>?_method=DELETE" method="POST">
										<button class="btn btn-xs btn-danger">Delete</button>
									</form>
								<% } %>
							</div>
						</div>
					<% }) %>
				</div>
			</div>
		</div>
	</div>
	<script>
		function initMap() {
			var lat = <%= campground.lat %>;
			var lng = <%= campground.lng %>;
			var center = {
				lat: lat,
				lng: lng
			};
			var map = new google.maps.Map(document.getElementById('map'), {
				zoom: 8,
				center: center,
				scrollwheel: false
			});
			var contentString = `
				<strong><%= campground.name %><br />
				<%= campground.location %></strong>
				<p><%= campground.description %></p>
			`
			var infowindow = new google.maps.InfoWindow({
				content: contentString
			});
			var marker = new google.maps.Marker({
				position: center,
				map: map
			});
			marker.addListener('click', function() {
				infowindow.open(map, marker);
			});
		}
	</script>
	<!-- <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD1tfXg009CO_oaKRZzJlSOyBj9AQEzcp8&callback=initMap"></script> -->
<% include ../partials/modals %>
<% include ../partials/footer %>
